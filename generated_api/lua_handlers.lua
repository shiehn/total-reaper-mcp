-- Generated Lua handlers for mcp_bridge.lua

            elseif fname == "CountTracks" then
                if #args >= 0 then
                    -- Implementation for CountTracks
                    response.ok = true
                else
                    response.error = "CountTracks requires 0 arguments"
                end

            elseif fname == "GetTrack" then
                if #args >= 1 then
                    -- Implementation for GetTrack
                    response.ok = true
                else
                    response.error = "GetTrack requires 1 arguments"
                end

            elseif fname == "GetMasterTrack" then
                if #args >= 0 then
                    -- Implementation for GetMasterTrack
                    response.ok = true
                else
                    response.error = "GetMasterTrack requires 0 arguments"
                end

            elseif fname == "GetTrackName" then
                if #args >= 1 then
                    -- Implementation for GetTrackName
                    response.ok = true
                else
                    response.error = "GetTrackName requires 1 arguments"
                end

            elseif fname == "GetSetMediaTrackInfo_String" then
                if #args >= 2 then
                    -- Implementation for GetSetMediaTrackInfo_String
                    response.ok = true
                else
                    response.error = "GetSetMediaTrackInfo_String requires 2 arguments"
                end

            elseif fname == "InsertTrackAtIndex" then
                if #args >= 1 then
                    -- Implementation for InsertTrackAtIndex
                    response.ok = true
                else
                    response.error = "InsertTrackAtIndex requires 1 arguments"
                end

            elseif fname == "DeleteTrack" then
                if #args >= 1 then
                    -- Implementation for DeleteTrack
                    response.ok = true
                else
                    response.error = "DeleteTrack requires 1 arguments"
                end

            elseif fname == "GetMediaTrackInfo_Value" then
                if #args >= 1 then
                    -- Implementation for GetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "GetMediaTrackInfo_Value requires 1 arguments"
                end

            elseif fname == "SetMediaTrackInfo_Value" then
                if #args >= 2 then
                    -- Implementation for SetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "SetMediaTrackInfo_Value requires 2 arguments"
                end

            elseif fname == "GetMediaTrackInfo_Value" then
                if #args >= 1 then
                    -- Implementation for GetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "GetMediaTrackInfo_Value requires 1 arguments"
                end

            elseif fname == "SetMediaTrackInfo_Value" then
                if #args >= 2 then
                    -- Implementation for SetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "SetMediaTrackInfo_Value requires 2 arguments"
                end

            elseif fname == "GetMediaTrackInfo_Value" then
                if #args >= 1 then
                    -- Implementation for GetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "GetMediaTrackInfo_Value requires 1 arguments"
                end

            elseif fname == "SetMediaTrackInfo_Value" then
                if #args >= 2 then
                    -- Implementation for SetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "SetMediaTrackInfo_Value requires 2 arguments"
                end

            elseif fname == "GetMediaTrackInfo_Value" then
                if #args >= 1 then
                    -- Implementation for GetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "GetMediaTrackInfo_Value requires 1 arguments"
                end

            elseif fname == "SetMediaTrackInfo_Value" then
                if #args >= 2 then
                    -- Implementation for SetMediaTrackInfo_Value
                    response.ok = true
                else
                    response.error = "SetMediaTrackInfo_Value requires 2 arguments"
                end

            elseif fname == "GetTrackColor" then
                if #args >= 1 then
                    -- Implementation for GetTrackColor
                    response.ok = true
                else
                    response.error = "GetTrackColor requires 1 arguments"
                end

            elseif fname == "SetTrackColor" then
                if #args >= 2 then
                    -- Implementation for SetTrackColor
                    response.ok = true
                else
                    response.error = "SetTrackColor requires 2 arguments"
                end

            elseif fname == "CountMediaItems" then
                if #args >= 0 then
                    -- Implementation for CountMediaItems
                    response.ok = true
                else
                    response.error = "CountMediaItems requires 0 arguments"
                end

            elseif fname == "GetMediaItem" then
                if #args >= 1 then
                    -- Implementation for GetMediaItem
                    response.ok = true
                else
                    response.error = "GetMediaItem requires 1 arguments"
                end

            elseif fname == "AddMediaItemToTrack" then
                if #args >= 1 then
                    -- Implementation for AddMediaItemToTrack
                    response.ok = true
                else
                    response.error = "AddMediaItemToTrack requires 1 arguments"
                end

            elseif fname == "DeleteTrackMediaItem" then
                if #args >= 2 then
                    -- Implementation for DeleteTrackMediaItem
                    response.ok = true
                else
                    response.error = "DeleteTrackMediaItem requires 2 arguments"
                end

            elseif fname == "GetMediaItemInfo_Value" then
                if #args >= 1 then
                    -- Implementation for GetMediaItemInfo_Value
                    response.ok = true
                else
                    response.error = "GetMediaItemInfo_Value requires 1 arguments"
                end

            elseif fname == "SetMediaItemInfo_Value" then
                if #args >= 2 then
                    -- Implementation for SetMediaItemInfo_Value
                    response.ok = true
                else
                    response.error = "SetMediaItemInfo_Value requires 2 arguments"
                end

            elseif fname == "GetMediaItemInfo_Value" then
                if #args >= 1 then
                    -- Implementation for GetMediaItemInfo_Value
                    response.ok = true
                else
                    response.error = "GetMediaItemInfo_Value requires 1 arguments"
                end

            elseif fname == "SetMediaItemInfo_Value" then
                if #args >= 2 then
                    -- Implementation for SetMediaItemInfo_Value
                    response.ok = true
                else
                    response.error = "SetMediaItemInfo_Value requires 2 arguments"
                end

            elseif fname == "CreateNewMIDIItemInProj" then
                if #args >= 3 then
                    -- Implementation for CreateNewMIDIItemInProj
                    response.ok = true
                else
                    response.error = "CreateNewMIDIItemInProj requires 3 arguments"
                end

            elseif fname == "CountTakes" then
                if #args >= 1 then
                    -- Implementation for CountTakes
                    response.ok = true
                else
                    response.error = "CountTakes requires 1 arguments"
                end

            elseif fname == "GetMediaItemTake" then
                if #args >= 2 then
                    -- Implementation for GetMediaItemTake
                    response.ok = true
                else
                    response.error = "GetMediaItemTake requires 2 arguments"
                end

            elseif fname == "GetActiveTake" then
                if #args >= 1 then
                    -- Implementation for GetActiveTake
                    response.ok = true
                else
                    response.error = "GetActiveTake requires 1 arguments"
                end

            elseif fname == "SetActiveTake" then
                if #args >= 1 then
                    -- Implementation for SetActiveTake
                    response.ok = true
                else
                    response.error = "SetActiveTake requires 1 arguments"
                end

            elseif fname == "AddTakeToMediaItem" then
                if #args >= 1 then
                    -- Implementation for AddTakeToMediaItem
                    response.ok = true
                else
                    response.error = "AddTakeToMediaItem requires 1 arguments"
                end

            elseif fname == "MIDI_InsertNote" then
                if #args >= 4 then
                    -- Implementation for MIDI_InsertNote
                    response.ok = true
                else
                    response.error = "MIDI_InsertNote requires 4 arguments"
                end

            elseif fname == "MIDI_DeleteNote" then
                if #args >= 2 then
                    -- Implementation for MIDI_DeleteNote
                    response.ok = true
                else
                    response.error = "MIDI_DeleteNote requires 2 arguments"
                end

            elseif fname == "MIDI_CountEvts" then
                if #args >= 1 then
                    -- Implementation for MIDI_CountEvts
                    response.ok = true
                else
                    response.error = "MIDI_CountEvts requires 1 arguments"
                end

            elseif fname == "MIDI_GetNote" then
                if #args >= 2 then
                    -- Implementation for MIDI_GetNote
                    response.ok = true
                else
                    response.error = "MIDI_GetNote requires 2 arguments"
                end

            elseif fname == "MIDI_SetNote" then
                if #args >= 2 then
                    -- Implementation for MIDI_SetNote
                    response.ok = true
                else
                    response.error = "MIDI_SetNote requires 2 arguments"
                end

            elseif fname == "MIDI_Sort" then
                if #args >= 1 then
                    -- Implementation for MIDI_Sort
                    response.ok = true
                else
                    response.error = "MIDI_Sort requires 1 arguments"
                end

            elseif fname == "MIDI_InsertCC" then
                if #args >= 6 then
                    -- Implementation for MIDI_InsertCC
                    response.ok = true
                else
                    response.error = "MIDI_InsertCC requires 6 arguments"
                end

            elseif fname == "MIDI_GetPPQPosFromProjTime" then
                if #args >= 2 then
                    -- Implementation for MIDI_GetPPQPosFromProjTime
                    response.ok = true
                else
                    response.error = "MIDI_GetPPQPosFromProjTime requires 2 arguments"
                end

            elseif fname == "MIDI_GetProjTimeFromPPQPos" then
                if #args >= 2 then
                    -- Implementation for MIDI_GetProjTimeFromPPQPos
                    response.ok = true
                else
                    response.error = "MIDI_GetProjTimeFromPPQPos requires 2 arguments"
                end

            elseif fname == "CSurf_OnPlay" then
                -- Implementation for CSurf_OnPlay
                response.ok = true

            elseif fname == "CSurf_OnStop" then
                -- Implementation for CSurf_OnStop
                response.ok = true

            elseif fname == "CSurf_OnPause" then
                -- Implementation for CSurf_OnPause
                response.ok = true

            elseif fname == "CSurf_OnRecord" then
                -- Implementation for CSurf_OnRecord
                response.ok = true

            elseif fname == "GetPlayState" then
                -- Implementation for GetPlayState
                response.ok = true

            elseif fname == "GetPlayPosition" then
                -- Implementation for GetPlayPosition
                response.ok = true

            elseif fname == "GetCursorPosition" then
                -- Implementation for GetCursorPosition
                response.ok = true

            elseif fname == "SetEditCurPos" then
                if #args >= 3 then
                    -- Implementation for SetEditCurPos
                    response.ok = true
                else
                    response.error = "SetEditCurPos requires 3 arguments"
                end

            elseif fname == "GoToMarker" then
                if #args >= 1 then
                    -- Implementation for GoToMarker
                    response.ok = true
                else
                    response.error = "GoToMarker requires 1 arguments"
                end

            elseif fname == "GoToRegion" then
                if #args >= 1 then
                    -- Implementation for GoToRegion
                    response.ok = true
                else
                    response.error = "GoToRegion requires 1 arguments"
                end

            elseif fname == "GetProjectName" then
                if #args >= 0 then
                    -- Implementation for GetProjectName
                    response.ok = true
                else
                    response.error = "GetProjectName requires 0 arguments"
                end

            elseif fname == "GetProjectPath" then
                if #args >= 0 then
                    -- Implementation for GetProjectPath
                    response.ok = true
                else
                    response.error = "GetProjectPath requires 0 arguments"
                end

            elseif fname == "Main_SaveProject" then
                if #args >= 0 then
                    -- Implementation for Main_SaveProject
                    response.ok = true
                else
                    response.error = "Main_SaveProject requires 0 arguments"
                end

            elseif fname == "IsProjectDirty" then
                if #args >= 0 then
                    -- Implementation for IsProjectDirty
                    response.ok = true
                else
                    response.error = "IsProjectDirty requires 0 arguments"
                end

            elseif fname == "MarkProjectDirty" then
                if #args >= 0 then
                    -- Implementation for MarkProjectDirty
                    response.ok = true
                else
                    response.error = "MarkProjectDirty requires 0 arguments"
                end

            elseif fname == "Master_GetTempo" then
                -- Implementation for Master_GetTempo
                response.ok = true

            elseif fname == "SetCurrentBPM" then
                if #args >= 1 then
                    -- Implementation for SetCurrentBPM
                    response.ok = true
                else
                    response.error = "SetCurrentBPM requires 1 arguments"
                end

            elseif fname == "TimeMap2_timeToBeats" then
                if #args >= 1 then
                    -- Implementation for TimeMap2_timeToBeats
                    response.ok = true
                else
                    response.error = "TimeMap2_timeToBeats requires 1 arguments"
                end

            elseif fname == "TimeMap2_beatsToTime" then
                if #args >= 1 then
                    -- Implementation for TimeMap2_beatsToTime
                    response.ok = true
                else
                    response.error = "TimeMap2_beatsToTime requires 1 arguments"
                end

            elseif fname == "AddProjectMarker" then
                if #args >= 2 then
                    -- Implementation for AddProjectMarker
                    response.ok = true
                else
                    response.error = "AddProjectMarker requires 2 arguments"
                end

            elseif fname == "DeleteProjectMarker" then
                if #args >= 1 then
                    -- Implementation for DeleteProjectMarker
                    response.ok = true
                else
                    response.error = "DeleteProjectMarker requires 1 arguments"
                end

            elseif fname == "CountProjectMarkers" then
                if #args >= 0 then
                    -- Implementation for CountProjectMarkers
                    response.ok = true
                else
                    response.error = "CountProjectMarkers requires 0 arguments"
                end

            elseif fname == "EnumProjectMarkers" then
                if #args >= 1 then
                    -- Implementation for EnumProjectMarkers
                    response.ok = true
                else
                    response.error = "EnumProjectMarkers requires 1 arguments"
                end

            elseif fname == "TrackFX_GetCount" then
                if #args >= 1 then
                    -- Implementation for TrackFX_GetCount
                    response.ok = true
                else
                    response.error = "TrackFX_GetCount requires 1 arguments"
                end

            elseif fname == "TrackFX_AddByName" then
                if #args >= 2 then
                    -- Implementation for TrackFX_AddByName
                    response.ok = true
                else
                    response.error = "TrackFX_AddByName requires 2 arguments"
                end

            elseif fname == "TrackFX_Delete" then
                if #args >= 2 then
                    -- Implementation for TrackFX_Delete
                    response.ok = true
                else
                    response.error = "TrackFX_Delete requires 2 arguments"
                end

            elseif fname == "TrackFX_GetEnabled" then
                if #args >= 2 then
                    -- Implementation for TrackFX_GetEnabled
                    response.ok = true
                else
                    response.error = "TrackFX_GetEnabled requires 2 arguments"
                end

            elseif fname == "TrackFX_SetEnabled" then
                if #args >= 3 then
                    -- Implementation for TrackFX_SetEnabled
                    response.ok = true
                else
                    response.error = "TrackFX_SetEnabled requires 3 arguments"
                end

            elseif fname == "TrackFX_GetParam" then
                if #args >= 3 then
                    -- Implementation for TrackFX_GetParam
                    response.ok = true
                else
                    response.error = "TrackFX_GetParam requires 3 arguments"
                end

            elseif fname == "TrackFX_SetParam" then
                if #args >= 4 then
                    -- Implementation for TrackFX_SetParam
                    response.ok = true
                else
                    response.error = "TrackFX_SetParam requires 4 arguments"
                end

            elseif fname == "GetTrackEnvelope" then
                if #args >= 2 then
                    -- Implementation for GetTrackEnvelope
                    response.ok = true
                else
                    response.error = "GetTrackEnvelope requires 2 arguments"
                end

            elseif fname == "GetTrackEnvelopeByName" then
                if #args >= 2 then
                    -- Implementation for GetTrackEnvelopeByName
                    response.ok = true
                else
                    response.error = "GetTrackEnvelopeByName requires 2 arguments"
                end

            elseif fname == "CountEnvelopePoints" then
                if #args >= 1 then
                    -- Implementation for CountEnvelopePoints
                    response.ok = true
                else
                    response.error = "CountEnvelopePoints requires 1 arguments"
                end

            elseif fname == "GetEnvelopePoint" then
                if #args >= 2 then
                    -- Implementation for GetEnvelopePoint
                    response.ok = true
                else
                    response.error = "GetEnvelopePoint requires 2 arguments"
                end

            elseif fname == "InsertEnvelopePoint" then
                if #args >= 3 then
                    -- Implementation for InsertEnvelopePoint
                    response.ok = true
                else
                    response.error = "InsertEnvelopePoint requires 3 arguments"
                end

            elseif fname == "DeleteEnvelopePointEx" then
                if #args >= 2 then
                    -- Implementation for DeleteEnvelopePointEx
                    response.ok = true
                else
                    response.error = "DeleteEnvelopePointEx requires 2 arguments"
                end

            elseif fname == "Undo_DoUndo2" then
                if #args >= 0 then
                    -- Implementation for Undo_DoUndo2
                    response.ok = true
                else
                    response.error = "Undo_DoUndo2 requires 0 arguments"
                end

            elseif fname == "Undo_DoRedo2" then
                if #args >= 0 then
                    -- Implementation for Undo_DoRedo2
                    response.ok = true
                else
                    response.error = "Undo_DoRedo2 requires 0 arguments"
                end

            elseif fname == "Undo_BeginBlock" then
                -- Implementation for Undo_BeginBlock
                response.ok = true

            elseif fname == "Undo_EndBlock" then
                if #args >= 1 then
                    -- Implementation for Undo_EndBlock
                    response.ok = true
                else
                    response.error = "Undo_EndBlock requires 1 arguments"
                end

            elseif fname == "Undo_CanUndo2" then
                if #args >= 0 then
                    -- Implementation for Undo_CanUndo2
                    response.ok = true
                else
                    response.error = "Undo_CanUndo2 requires 0 arguments"
                end

            elseif fname == "Undo_CanRedo2" then
                if #args >= 0 then
                    -- Implementation for Undo_CanRedo2
                    response.ok = true
                else
                    response.error = "Undo_CanRedo2 requires 0 arguments"
                end

            elseif fname == "Main_OnCommand" then
                if #args >= 1 then
                    -- Implementation for Main_OnCommand
                    response.ok = true
                else
                    response.error = "Main_OnCommand requires 1 arguments"
                end

            elseif fname == "Main_OnCommandEx" then
                if #args >= 1 then
                    -- Implementation for Main_OnCommandEx
                    response.ok = true
                else
                    response.error = "Main_OnCommandEx requires 1 arguments"
                end

            elseif fname == "kbd_getTextFromCmd" then
                if #args >= 1 then
                    -- Implementation for kbd_getTextFromCmd
                    response.ok = true
                else
                    response.error = "kbd_getTextFromCmd requires 1 arguments"
                end

            elseif fname == "NamedCommandLookup" then
                if #args >= 1 then
                    -- Implementation for NamedCommandLookup
                    response.ok = true
                else
                    response.error = "NamedCommandLookup requires 1 arguments"
                end

            elseif fname == "UpdateArrange" then
                -- Implementation for UpdateArrange
                response.ok = true

            elseif fname == "UpdateTimeline" then
                -- Implementation for UpdateTimeline
                response.ok = true

            elseif fname == "TrackList_UpdateAllExternalSurfaces" then
                -- Implementation for TrackList_UpdateAllExternalSurfaces
                response.ok = true

            elseif fname == "RefreshToolbar" then
                if #args >= 1 then
                    -- Implementation for RefreshToolbar
                    response.ok = true
                else
                    response.error = "RefreshToolbar requires 1 arguments"
                end

            elseif fname == "RefreshToolbar2" then
                if #args >= 2 then
                    -- Implementation for RefreshToolbar2
                    response.ok = true
                else
                    response.error = "RefreshToolbar2 requires 2 arguments"
                end

            elseif fname == "CreateTrackSend" then
                if #args >= 2 then
                    -- Implementation for CreateTrackSend
                    response.ok = true
                else
                    response.error = "CreateTrackSend requires 2 arguments"
                end

            elseif fname == "RemoveTrackSend" then
                if #args >= 3 then
                    -- Implementation for RemoveTrackSend
                    response.ok = true
                else
                    response.error = "RemoveTrackSend requires 3 arguments"
                end

            elseif fname == "GetTrackNumSends" then
                if #args >= 1 then
                    -- Implementation for GetTrackNumSends
                    response.ok = true
                else
                    response.error = "GetTrackNumSends requires 1 arguments"
                end

            elseif fname == "CountSelectedTracks" then
                local count = reaper.CountSelectedTracks(args[1] or 0)
                response.ok = true
                response.ret = count

            elseif fname == "GetSelectedTrack" then
                if #args >= 2 then
                    local track = reaper.GetSelectedTrack(args[1], args[2])
                    response.ok = true
                    response.ret = track
                else
                    response.error = "GetSelectedTrack requires 2 arguments"
                end

            elseif fname == "SetTrackSelected" then
                if #args >= 2 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        reaper.SetTrackSelected(track, args[2])
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "SetTrackSelected requires 2 arguments"
                end

            elseif fname == "CountSelectedMediaItems" then
                local count = reaper.CountSelectedMediaItems(args[1] or 0)
                response.ok = true
                response.ret = count

            elseif fname == "GetSelectedMediaItem" then
                if #args >= 2 then
                    local item = reaper.GetSelectedMediaItem(args[1], args[2])
                    response.ok = true
                    response.ret = item
                else
                    response.error = "GetSelectedMediaItem requires 2 arguments"
                end

            elseif fname == "SetMediaItemSelected" then
                if #args >= 2 then
                    local item = reaper.GetMediaItem(0, args[1])
                    if item then
                        reaper.SetMediaItemSelected(item, args[2])
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid item index"
                    end
                else
                    response.error = "SetMediaItemSelected requires 2 arguments"
                end

            elseif fname == "SelectAllMediaItems" then
                reaper.SelectAllMediaItems(args[1] or 0)
                response.ok = true
                response.ret = true

            elseif fname == "UnselectAllMediaItems" then
                reaper.Main_OnCommand(40289, 0) -- Unselect all items
                response.ok = true
                response.ret = true

            elseif fname == "GetMediaItemTake_Source" then
                if #args >= 1 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local source = reaper.GetMediaItemTake_Source(take)
                        response.ok = true
                        response.ret = source
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "GetMediaItemTake_Source requires 1 argument"
                end

            elseif fname == "GetMediaSourceFileName" then
                if #args >= 1 then
                    -- Note: This would need proper source management
                    response.ok = true
                    response.ret = "source_filename.wav"
                else
                    response.error = "GetMediaSourceFileName requires 1 argument"
                end

            elseif fname == "GetMediaSourceLength" then
                if #args >= 1 then
                    -- Note: This would need proper source management
                    response.ok = true
                    response.ret = 10.0
                else
                    response.error = "GetMediaSourceLength requires 1 argument"
                end

            elseif fname == "GetMediaSourceType" then
                if #args >= 1 then
                    -- Note: This would need proper source management
                    response.ok = true
                    response.ret = "WAVE"
                else
                    response.error = "GetMediaSourceType requires 1 argument"
                end

            elseif fname == "PCM_Source_CreateFromFile" then
                if #args >= 1 then
                    local source = reaper.PCM_Source_CreateFromFile(args[1])
                    response.ok = true
                    response.ret = source
                else
                    response.error = "PCM_Source_CreateFromFile requires 1 argument"
                end

            elseif fname == "SetMediaItemTake_Source" then
                if #args >= 2 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        -- Note: This would need proper source management
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "SetMediaItemTake_Source requires 2 arguments"
                end

            elseif fname == "GetMediaItemTake_Peaks" then
                if #args >= 1 then
                    -- Note: This is a simplified implementation
                    response.ok = true
                    response.ret = "peak_data"
                else
                    response.error = "GetMediaItemTake_Peaks requires at least 1 argument"
                end

            elseif fname == "GetTrackDepth" then
                if #args >= 1 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        local depth = reaper.GetTrackDepth(track)
                        response.ok = true
                        response.ret = depth
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "GetTrackDepth requires 1 argument"
                end

            elseif fname == "GetParentTrack" then
                if #args >= 1 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        local parent = reaper.GetParentTrack(track)
                        response.ok = true
                        response.ret = parent
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "GetParentTrack requires 1 argument"
                end

            elseif fname == "SetTrackHeight" then
                if #args >= 2 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        reaper.SetMediaTrackInfo_Value(track, "I_HEIGHTOVERRIDE", args[2])
                        if args[3] then
                            reaper.SetMediaTrackInfo_Value(track, "B_HEIGHTLOCK", args[3] and 1 or 0)
                        end
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "SetTrackHeight requires at least 2 arguments"
                end

            elseif fname == "FreezeTrack" then
                if #args >= 1 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        -- Set track to freeze
                        reaper.SetMediaTrackInfo_Value(track, "I_FREEMODE", 1)
                        -- Execute freeze
                        reaper.Main_OnCommand(41223, 0) -- Track: Freeze to stereo
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "FreezeTrack requires 1 argument"
                end

            elseif fname == "UnfreezeTrack" then
                if #args >= 1 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        -- Unfreeze track
                        reaper.SetMediaTrackInfo_Value(track, "I_FREEMODE", 0)
                        reaper.Main_OnCommand(41644, 0) -- Track: Unfreeze
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "UnfreezeTrack requires 1 argument"
                end

            elseif fname == "ApplyFXToItems" then
                if #args >= 1 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        -- Select track
                        reaper.SetTrackSelected(track, true)
                        -- Apply FX to items
                        reaper.Main_OnCommand(40209, 0) -- Item: Apply track FX to items
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "ApplyFXToItems requires 1 argument"
                end

            elseif fname == "MIDI_GetAllEvts" then
                if #args >= 1 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local retval, buf = reaper.MIDI_GetAllEvts(take, "")
                        response.ok = true
                        response.ret = buf
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_GetAllEvts requires 1 argument"
                end

            elseif fname == "MIDI_SetAllEvts" then
                if #args >= 2 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        reaper.MIDI_SetAllEvts(take, args[2])
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_SetAllEvts requires 2 arguments"
                end

            elseif fname == "GetNoteName" then
                if #args >= 1 then
                    local note_names = {"C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"}
                    local note = args[1]
                    local octave = math.floor(note / 12) - 1
                    local note_name = note_names[(note % 12) + 1]
                    response.ok = true
                    response.ret = note_name .. octave
                else
                    response.error = "GetNoteName requires 1 argument"
                end

            elseif fname == "MIDI_GetScale" then
                if #args >= 1 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local retval, root, scale, name = reaper.MIDI_GetScale(take, 0, 0, "")
                        response.ok = true
                        response.root = root
                        response.scale = scale
                        response.name = name
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_GetScale requires 1 argument"
                end

            elseif fname == "MIDI_SetScale" then
                if #args >= 3 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        reaper.MIDI_SetScale(take, args[2], args[3], args[4] or 0)
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_SetScale requires at least 3 arguments"
                end

            elseif fname == "MIDI_GetTextSysexEvt" then
                if #args >= 2 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local retval, selected, muted, ppqpos, type, msg = reaper.MIDI_GetTextSysexEvt(take, args[2], false, false, 0, 0, "")
                        response.ok = true
                        response.selected = selected
                        response.muted = muted
                        response.ppqpos = ppqpos
                        response.type = type
                        response.message = msg
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_GetTextSysexEvt requires 2 arguments"
                end

            elseif fname == "MIDI_SetTextSysexEvt" then
                if #args >= 7 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        reaper.MIDI_SetTextSysexEvt(take, args[2], args[3], args[4], args[5], args[6], args[7])
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_SetTextSysexEvt requires 7 arguments"
                end

            elseif fname == "MIDI_CountEvts" then
                if #args >= 1 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local retval, notes, cc, text = reaper.MIDI_CountEvts(take)
                        response.ok = true
                        response.notes = notes
                        response.cc = cc
                        response.text = text
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_CountEvts requires 1 argument"
                end

            elseif fname == "MIDI_EnumSelNotes" then
                if #args >= 2 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local note_idx = reaper.MIDI_EnumSelNotes(take, args[2])
                        response.ok = true
                        response.ret = note_idx
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_EnumSelNotes requires 2 arguments"
                end

            elseif fname == "MIDI_SelectAll" then
                if #args >= 1 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        reaper.MIDI_SelectAll(take, args[2] ~= false)
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "MIDI_SelectAll requires at least 1 argument"
                end

            elseif fname == "GetResourcePath" then
                local path = reaper.GetResourcePath()
                response.ok = true
                response.ret = path

            elseif fname == "GetExePath" then
                local path = reaper.GetExePath()
                response.ok = true
                response.ret = path

            elseif fname == "RecursiveCreateDirectory" then
                if #args >= 1 then
                    local result = reaper.RecursiveCreateDirectory(args[1], args[2] or 0)
                    response.ok = true
                    response.ret = result
                else
                    response.error = "RecursiveCreateDirectory requires at least 1 argument"
                end

            elseif fname == "GetProjectPath" then
                local proj = args[1] and reaper.EnumProjects(args[1]) or 0
                local retval, path = reaper.GetProjectPath(proj, "")
                response.ok = true
                response.ret = path

            elseif fname == "GetProjectStateChangeCount" then
                local proj = args[1] and reaper.EnumProjects(args[1]) or 0
                local count = reaper.GetProjectStateChangeCount(proj)
                response.ok = true
                response.ret = count

            elseif fname == "GetTrackStateChunk" then
                if #args >= 1 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        local retval, chunk = reaper.GetTrackStateChunk(track, "", args[2] or false)
                        response.ok = true
                        response.ret = chunk
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "GetTrackStateChunk requires at least 1 argument"
                end

            elseif fname == "SetTrackStateChunk" then
                if #args >= 2 then
                    local track = reaper.GetTrack(0, args[1])
                    if track then
                        local result = reaper.SetTrackStateChunk(track, args[2], args[3] or false)
                        response.ok = true
                        response.ret = result
                    else
                        response.error = "Invalid track index"
                    end
                else
                    response.error = "SetTrackStateChunk requires at least 2 arguments"
                end

            elseif fname == "BrowseForFile" then
                if #args >= 2 then
                    -- Note: This would open a dialog in REAPER
                    response.ok = true
                    response.ret = "file_browser_not_available_in_automation"
                else
                    response.error = "BrowseForFile requires 2 arguments"
                end

            elseif fname == "ShowConsoleMsg" then
                if #args >= 1 then
                    reaper.ShowConsoleMsg(args[1])
                    response.ok = true
                    response.ret = true
                else
                    response.error = "ShowConsoleMsg requires 1 argument"
                end

            elseif fname == "ClearConsole" then
                reaper.ClearConsole()
                response.ok = true
                response.ret = true

            elseif fname == "MB" then
                if #args >= 3 then
                    local result = reaper.MB(args[1], args[2], args[3])
                    response.ok = true
                    response.ret = result
                else
                    response.error = "MB requires 3 arguments"
                end

            elseif fname == "GetMainHwnd" then
                local hwnd = reaper.GetMainHwnd()
                response.ok = true
                response.ret = tostring(hwnd)

            elseif fname == "DockWindowAdd" then
                if #args >= 3 then
                    -- Note: This requires actual window handle
                    response.ok = true
                    response.ret = "dock_window_not_available_in_automation"
                else
                    response.error = "DockWindowAdd requires at least 3 arguments"
                end

            elseif fname == "GetMousePosition" then
                local x, y = reaper.GetMousePosition()
                response.ok = true
                response.x = x
                response.y = y

            elseif fname == "GetCursorContext" then
                local context = reaper.GetCursorContext()
                response.ok = true
                response.ret = context

            elseif fname == "GetMediaItemInfo_Value" then
                if #args >= 2 then
                    local item = reaper.GetMediaItem(0, args[1])
                    if item then
                        local value = reaper.GetMediaItemInfo_Value(item, args[2])
                        response.ok = true
                        response.ret = value
                    else
                        response.error = "Invalid item index"
                    end
                else
                    response.error = "GetMediaItemInfo_Value requires 2 arguments"
                end

            elseif fname == "SetMediaItemInfo_Value" then
                if #args >= 3 then
                    local item = reaper.GetMediaItem(0, args[1])
                    if item then
                        reaper.SetMediaItemInfo_Value(item, args[2], args[3])
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid item index"
                    end
                else
                    response.error = "SetMediaItemInfo_Value requires 3 arguments"
                end

            elseif fname == "GetTakeName" then
                if #args >= 1 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local retval, name = reaper.GetSetMediaItemTakeInfo_String(take, "P_NAME", "", false)
                        response.ok = true
                        response.ret = name
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "GetTakeName requires 1 argument"
                end

            elseif fname == "GetSetMediaItemTakeInfo_String" then
                if #args >= 4 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local retval, str = reaper.GetSetMediaItemTakeInfo_String(take, args[2], args[3], args[4])
                        response.ok = true
                        response.ret = str
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "GetSetMediaItemTakeInfo_String requires 4 arguments"
                end

            elseif fname == "GetMediaItemTakeInfo_Value" then
                if #args >= 2 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        local value = reaper.GetMediaItemTakeInfo_Value(take, args[2])
                        response.ok = true
                        response.ret = value
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "GetMediaItemTakeInfo_Value requires 2 arguments"
                end

            elseif fname == "SetMediaItemTakeInfo_Value" then
                if #args >= 3 then
                    local take = reaper.GetMediaItemTake(reaper.GetMediaItem(0, args[1]), 0)
                    if take then
                        reaper.SetMediaItemTakeInfo_Value(take, args[2], args[3])
                        response.ok = true
                        response.ret = true
                    else
                        response.error = "Invalid take index"
                    end
                else
                    response.error = "SetMediaItemTakeInfo_Value requires 3 arguments"
                end

            elseif fname == "GetItemStateChunk" then
                if #args >= 1 then
                    local item = reaper.GetMediaItem(0, args[1])
                    if item then
                        local retval, chunk = reaper.GetItemStateChunk(item, "", args[2] or false)
                        response.ok = true
                        response.ret = chunk
                    else
                        response.error = "Invalid item index"
                    end
                else
                    response.error = "GetItemStateChunk requires at least 1 argument"
                end

            elseif fname == "SetItemStateChunk" then
                if #args >= 2 then
                    local item = reaper.GetMediaItem(0, args[1])
                    if item then
                        local result = reaper.SetItemStateChunk(item, args[2], args[3] or false)
                        response.ok = true
                        response.ret = result
                    else
                        response.error = "Invalid item index"
                    end
                else
                    response.error = "SetItemStateChunk requires at least 2 arguments"
                end

            elseif fname == "SplitMediaItem" then
                if #args >= 2 then
                    local item = reaper.GetMediaItem(0, args[1])
                    if item then
                        local new_item = reaper.SplitMediaItem(item, args[2])
                        response.ok = true
                        response.ret = new_item ~= nil
                    else
                        response.error = "Invalid item index"
                    end
                else
                    response.error = "SplitMediaItem requires 2 arguments"
                end

